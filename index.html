<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SwenShop POS Pro</title>
<style>
  body { background:#000; color:#FFD700; font-family:Arial,sans-serif; margin:0; padding:0; }
  h1,h2,h3 { text-align:center; color:gold; }
  .container { padding:10px; }
  /* Modals */
  #pinModal, #staffModal, #customProductModal { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); display:flex; justify-content:center; align-items:center; z-index:999; }
  .hidden { display:none; }
  .modalBox { background:#111; padding:20px; border-radius:8px; text-align:center; max-width:400px; width:90%; }
  .modalBox input, .modalBox select { padding:8px; width:80%; margin-bottom:10px; text-align:center; font-size:16px; }
  .modalBox button { padding:10px 15px; margin:5px; background:gold; color:black; border:none; border-radius:6px; font-weight:bold; cursor:pointer; }
  /* POS Grid */
  #productsGrid { display:grid; grid-template-columns:repeat(auto-fill,minmax(100px,1fr)); gap:10px; margin-bottom:10px; }
  .product-card { background:#111; padding:10px; border-radius:8px; text-align:center; display:flex; flex-direction:column; justify-content:space-between; }
  .product-card button { margin-top:5px; padding:8px; background:gold; border:none; color:black; font-weight:bold; cursor:pointer; font-size:14px; border-radius:4px;}
  .badge-low { background:red; color:white; padding:2px 4px; font-size:10px; border-radius:4px; margin-top:4px;}
  /* Cart */
  #cartList li { display:flex; justify-content:space-between; margin-bottom:4px; }
  .btnRemove { background:red; color:white; border:none; border-radius:4px; cursor:pointer; padding:2px 5px; }
  .order-actions button { width:48%; padding:12px; background:gold; border:none; font-size:16px; color:black; cursor:pointer; border-radius:6px; margin-top:10px; font-weight:bold;}
  /* Staff Clock-In Table */
  table { width:100%; border-collapse:collapse; margin-bottom:10px; }
  th, td { border:1px solid gold; padding:6px; text-align:center; }
  .btnClock { padding:4px 8px; background:gold; color:black; border:none; border-radius:4px; cursor:pointer; font-weight:bold;}
</style>
</head>
<body>

<div id="pinModal">
  <div class="modalBox">
    <h2>Enter PIN</h2>
    <input type="password" id="pinInput" placeholder="PIN">
    <div>
      <button id="pinLogin">Login</button>
      <button id="pinGuest">Guest</button>
    </div>
  </div>
</div>

<div id="staffModal" class="hidden">
  <div class="modalBox">
    <h2>Staff Management</h2>
    <input type="text" id="staffNameInput" placeholder="Staff Name">
    <button id="addStaffBtn">Add Staff</button>
    <table>
      <thead>
        <tr><th>Name</th><th>Status</th><th>Clock-In</th><th>Break</th><th>Clock-Out</th></tr>
      </thead>
      <tbody id="staffList"></tbody>
    </table>
    <button onclick="closeStaffModal()">Close</button>
  </div>
</div>

<div id="customProductModal" class="hidden">
  <div class="modalBox">
    <h2>Add Custom Product</h2>
    <input type="text" id="customProdName" placeholder="Product Name">
    <input type="number" id="customProdPrice" placeholder="Price" min="0" step="0.01">
    <button id="addCustomProdBtn">Add to Cart</button>
    <button onclick="closeCustomProductModal()">Cancel</button>
  </div>
</div>

<div class="container">
<h1>SwenShop POS Pro</h1>

<!-- Admin Button -->
<button onclick="openStaffModal()">‚öôÔ∏è Staff/Admin Settings</button>

<!-- Products Grid -->
<h2>Products</h2>
<div id="productsGrid"></div>

<!-- Custom Product -->
<button onclick="openCustomProductModal()">‚ûï Add Custom Product</button>

<!-- Cart / Order Summary -->
<h2>Order</h2>
Customer Name: <input type="text" id="custName" placeholder="Optional"><br><br>
<ul id="cartList"></ul>
<div>Total: <span id="cartTotal">0.00</span></div>
<div class="order-actions">
  <button id="placeOrderBtn">Place Order</button>
  <button id="sendWhatsAppBtn">Send WhatsApp</button>
  <button id="printTicketBtn">Print Ticket</button>
  <button onclick="newOrder()">New Order</button>
</div>
</div>

<script>
/* ===== CONFIG ===== */
const WHATSAPP_NUMBER = "50585065976";
const STORE_KEY = "swenpos_pro_v2";
let state = JSON.parse(localStorage.getItem(STORE_KEY)) || {
    pin:"1234",
    staff:[],
    products:[
        {name:"Fries Classic", price:3.5, qty:20},
        {name:"Cheesy Fries", price:4.5, qty:12},
        {name:"Bacon Fries", price:5.5, qty:8},
        {name:"Burger", price:7, qty:6},
        {name:"Soda", price:1.5, qty:30},
        {name:"Combo 1", price:10, qty:10},
        {name:"Extra Cheese", price:0.8, qty:50}
    ],
    orders:[]
};

/* ===== PIN LOGIN ===== */
const pinModal = document.getElementById("pinModal");
const pinInput = document.getElementById("pinInput");
document.getElementById("pinLogin").onclick = ()=>{
    if(pinInput.value === state.pin){
        pinModal.classList.add("hidden"); renderAll();
        // Removed auto staff modal
    } else alert("Incorrect PIN");
}
document.getElementById("pinGuest").onclick = ()=>{
    pinModal.classList.add("hidden"); renderAll();
};

/* ===== STAFF MANAGEMENT MODAL ===== */
const staffModal = document.getElementById("staffModal");
const staffList = document.getElementById("staffList");
const staffNameInput = document.getElementById("staffNameInput");
document.getElementById("addStaffBtn").onclick = ()=>{
    const name = staffNameInput.value.trim();
    if(!name) return;
    state.staff.push({name, checkedIn:false, onBreak:false, totalTime:0, startTime:null});
    staffNameInput.value=""; saveState(); renderStaff();
}
function openStaffModal(){ staffModal.classList.remove("hidden"); renderStaff(); }
function closeStaffModal(){ staffModal.classList.add("hidden"); }
function clockIn(idx){
    const s=state.staff[idx];
    if(!s.checkedIn){ s.checkedIn=true; s.startTime=Date.now(); s.onBreak=false; }
    saveState(); renderStaff();
}
function startBreak(idx){
    const s=state.staff[idx];
    if(s.checkedIn && !s.onBreak){ s.onBreak=true; s.totalTime += (Date.now()-s.startTime); }
    else if(s.onBreak){ s.onBreak=false; s.startTime=Date.now(); }
    saveState(); renderStaff();
}
function clockOut(idx){
    const s=state.staff[idx];
    if(s.checkedIn){ if(!s.onBreak) s.totalTime += (Date.now()-s.startTime); s.checkedIn=false; s.startTime=null; s.onBreak=false; alert(`${s.name} worked ${(s.totalTime/1000/60).toFixed(2)} minutes`); s.totalTime=0; }
    saveState(); renderStaff();
}
function renderStaff(){
    staffList.innerHTML="";
    state.staff.forEach((s,idx)=>{
        const tr=document.createElement("tr");
        tr.innerHTML=`
        <td>${s.name}</td>
        <td>${s.checkedIn ? (s.onBreak?"On Break":"Working") : "Offline"}</td>
        <td><button class="btnClock" onclick="clockIn(${idx})" ${s.checkedIn?"disabled":""}>Clock-In</button></td>
        <td><button class="btnClock" onclick="startBreak(${idx})" ${!s.checkedIn?"disabled":""}>Break/Resume</button></td>
        <td><button class="btnClock" onclick="clockOut(${idx})" ${!s.checkedIn?"disabled":""}>Clock-Out</button></td>
        `;
        staffList.appendChild(tr);
    });
}

/* ====== CUSTOM PRODUCT MODAL ===== */
const customProductModal = document.getElementById("customProductModal");
function openCustomProductModal(){ customProductModal.classList.remove("hidden"); }
function closeCustomProductModal(){ customProductModal.classList.add("hidden"); }
document.getElementById("addCustomProdBtn").onclick = ()=>{
    const name=document.getElementById("customProdName").value.trim();
    const price=parseFloat(document.getElementById("customProdPrice").value);
    if(!name || isNaN(price)) return alert("Invalid input");
    cart.push({name, price}); renderCart(); closeCustomProductModal();
}

/* ====== PRODUCTS GRID ===== */
const productsGrid = document.getElementById("productsGrid");
let cart=[], cartTotal=0;
function renderProducts(){
    productsGrid.innerHTML="";
    state.products.forEach((p,idx)=>{
        const card=document.createElement("div"); card.className="product-card";
        card.innerHTML=`<div>${p.name}</div><div>C$${p.price}</div><div>Stock: ${p.qty}</div>`;
        const btn=document.createElement("button"); btn.textContent="Add"; btn.disabled = p.qty<=0;
        btn.onclick = ()=>{ cart.push(p); cartTotal+=p.price; renderCart(); };
        card.appendChild(btn);
        if(p.qty<=2){ const badge=document.createElement("div"); badge.className="badge-low"; badge.textContent="LOW"; card.appendChild(badge);}
        productsGrid.appendChild(card);
    });
}

/* ====== CART ===== */
const cartList=document.getElementById("cartList");
const cartTotalEl=document.getElementById("cartTotal");
const custName=document.getElementById("custName");
function renderCart(){
    cartList.innerHTML=""; cartTotal=0;
    cart.forEach((item,idx)=>{
        const li=document.createElement("li");
        li.innerHTML=`<span>${item.name}</span><span>C$${item.price}</span>`;
        const btn=document.createElement("button"); btn.textContent="X"; btn.className="btnRemove";
        btn.onclick=()=>{ cart.splice(idx,1); renderCart(); };
        li.appendChild(btn); cartList.appendChild(li); cartTotal+=item.price;
    });
    cartTotalEl.innerText=cartTotal.toFixed(2);
}

/* ====== ORDERS / TICKET / WHATSAPP ===== */
document.getElementById("placeOrderBtn").onclick = ()=>{
    if(cart.length===0){ alert("Cart empty"); return; }
    state.orders.push({items:[...cart], total:cartTotal, customer:custName.value, time:new Date().toISOString()});
    saveState(); renderCart(); renderProducts();
    // Print kitchen ticket automatically
    const w=window.open("","PRINT","height=600,width=400");
    w.document.write(`<pre style="font-size:18px;">French Fries Bar & Grill
Order Ticket
${new Date().toLocaleString()}

${cart.map(i=>i.name+" - C$"+i.price).join("\n")}

-------------------------
TOTAL: C$${cartTotal.toFixed(2)}
</pre>`);
    w.document.close(); w.focus(); w.print();
    cart=[]; cartTotal=0; custName.value=""; renderCart();
};

document.getElementById("sendWhatsAppBtn").onclick = ()=>{
    if(cart.length===0){ alert("Cart empty"); return; }
    let msg=`üî• New Order\n`;
    if(custName.value) msg+=`Customer: ${custName.value}\n`;
    cart.forEach(i=> msg+=`${i.name} - C$${i.price}\n`);
    msg+=`Total: C$${cartTotal.toFixed(2)}\nTime: ${new Date().toLocaleString()}`;
    window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(msg)}`,"_blank");
};

/* ====== New Order ===== */
function newOrder(){ cart=[]; cartTotal=0; custName.value=""; renderCart(); }

/* ====== SAVE / LOAD ===== */
function saveState(){ localStorage.setItem(STORE_KEY, JSON.stringify(state)); }

/* ====== RENDER ALL ===== */
function renderAll(){ renderProducts(); renderCart(); renderStaff(); }
renderAll();
</script>

</body>
</html>
