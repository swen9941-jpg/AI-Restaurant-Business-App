<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Luxury POS System</title>
<style>
  body { font-family: Arial, sans-serif; background: #111; color: #f5d000; margin:0; padding:0; }
  header { background:#000; color:#f5d000; padding:15px; text-align:center; font-size:24px; }
  .container { display:flex; flex-wrap:wrap; padding:10px; }
  .category-btn { background:#222; color:#f5d000; border:none; margin:5px; padding:10px 15px; cursor:pointer; font-weight:bold; border-radius:5px; }
  .product-card { background:#222; border-radius:8px; padding:10px; margin:5px; width:150px; text-align:center; flex:1 0 21%; box-shadow:0 0 10px #f5d000; }
  .product-card button { background:#f5d000; color:#000; border:none; padding:5px 10px; margin-top:5px; cursor:pointer; border-radius:4px; font-weight:bold; width:100%; }
  .badge-low { background:red; color:white; padding:2px 5px; border-radius:3px; font-size:12px; margin-top:5px; display:inline-block; }
  #cart { background:#111; padding:10px; width:300px; float:right; border-left:2px solid #f5d000; height:100vh; overflow:auto; }
  #cart h2 { text-align:center; }
  #cart ul { list-style:none; padding:0; }
  #cart li { display:flex; justify-content:space-between; align-items:center; margin:5px 0; }
  .btn-small { background:#f5d000; border:none; padding:2px 5px; cursor:pointer; color:#000; border-radius:3px; margin-left:5px; }
  .modal { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); display:none; justify-content:center; align-items:center; color:#f5d000; z-index:999; }
  .modal-content { background:#222; padding:20px; border-radius:10px; width:400px; max-height:80%; overflow:auto; }
  .modal-content input, .modal-content select { width:100%; padding:5px; margin:5px 0; border-radius:4px; border:none; }
  .modal-content button { margin-top:10px; }
  #staffList li, #expenseList li { margin:5px 0; }
</style>
</head>
<body>

<header>Luxury POS System</header>

<div class="container" id="categoryContainer">
  <button class="category-btn" data-cat="All">All</button>
  <button class="category-btn" data-cat="Fries">Fries</button>
  <button class="category-btn" data-cat="Burgers">Burgers</button>
  <button class="category-btn" data-cat="Drinks">Drinks</button>
</div>

<div class="container" id="productsGrid"></div>

<div id="cart">
  <h2>Cart</h2>
  <ul id="cartList"></ul>
  <div>Total: $<span id="cartTotal">0.00</span></div>
  <button id="placeOrder">Place Order</button>
  <button id="addCustomBtn">Add Custom Product</button>
  <button id="manageStaffBtn">Manage Staff</button>
  <button id="manageExpensesBtn">Expenses</button>
</div>

<!-- Custom Product Modal -->
<div class="modal" id="customModal">
  <div class="modal-content">
    <h3>Add Custom Product</h3>
    <input type="text" id="customName" placeholder="Product Name">
    <input type="number" id="customPrice" placeholder="Price" step="0.01">
    <input type="number" id="customQty" placeholder="Quantity" step="1">
    <button id="saveCustom">Add to Cart</button>
    <button id="cancelCustom">Cancel</button>
  </div>
</div>

<!-- Staff Modal -->
<div class="modal" id="staffModal">
  <div class="modal-content">
    <h3>Staff Management</h3>
    <input type="text" id="staffName" placeholder="Staff Name">
    <select id="staffAction">
      <option value="checkin">Clock In</option>
      <option value="break">Break/Restroom</option>
      <option value="checkout">Clock Out</option>
    </select>
    <button id="saveStaff">Submit</button>
    <button id="closeStaff">Close</button>
    <h4>Staff Today:</h4>
    <ul id="staffList"></ul>
  </div>
</div>

<!-- Expenses Modal -->
<div class="modal" id="expenseModal">
  <div class="modal-content">
    <h3>Expenses</h3>
    <input type="text" id="expenseName" placeholder="Expense Name">
    <input type="number" id="expenseAmount" placeholder="Amount" step="0.01">
    <button id="saveExpense">Add Expense</button>
    <button id="closeExpense">Close</button>
    <h4>Expense List:</h4>
    <ul id="expenseList"></ul>
  </div>
</div>

<script>
// ---------- Data ----------
const STORE_KEY="pos_luxury_v2";
let state = JSON.parse(localStorage.getItem(STORE_KEY)) || {
  products: [
    { name:"Fries Classic", price:3.5, qty:20, category:"Fries" },
    { name:"Cheesy Fries", price:4.5, qty:12, category:"Fries" },
    { name:"Bacon Fries", price:5.5, qty:8, category:"Fries" },
    { name:"Burger", price:7, qty:6, category:"Burgers" },
    { name:"Soda", price:1.5, qty:30, category:"Drinks" }
  ],
  orders: [],
  staff: {},
  expenses: []
};
let cart=[];

// ---------- Save ----------
function saveState(){ localStorage.setItem(STORE_KEY, JSON.stringify(state)); }

// ---------- Render Products ----------
const productsGrid = document.getElementById("productsGrid");
const categoryContainer = document.getElementById("categoryContainer");

function renderProducts(filter="All"){
  productsGrid.innerHTML="";
  state.products.filter(p=>filter==="All"||p.category===filter).forEach(prod=>{
    const card = document.createElement("div"); card.className="product-card";
    card.innerHTML=`<div>${prod.name}</div>
                    <div>$${prod.price.toFixed(2)}</div>
                    <div>Stock: ${prod.qty}</div>`;
    if(prod.qty<=2) card.innerHTML += `<div class="badge-low">LOW</div>`;
    const btn = document.createElement("button");
    btn.textContent="Add to Cart";
    btn.disabled=prod.qty<=0;
    btn.onclick=()=> addToCart(prod);
    card.appendChild(btn);
    productsGrid.appendChild(card);
  });
}

// ---------- Category Filter ----------
categoryContainer.querySelectorAll(".category-btn").forEach(btn=>{
  btn.addEventListener("click", ()=>renderProducts(btn.dataset.cat));
});

// ---------- Add to Cart ----------
function addToCart(prod){
  cart.push({...prod});
  renderCart();
}

// ---------- Render Cart ----------
const cartList=document.getElementById("cartList");
const cartTotal=document.getElementById("cartTotal");

function renderCart(){
  cartList.innerHTML="";
  let total=0;
  cart.forEach((item,i)=>{
    const li=document.createElement("li");
    li.innerHTML=`<div>${item.name} - $${item.price.toFixed(2)}</div>`;
    const rm=document.createElement("button"); rm.className="btn-small"; rm.textContent="x";
    rm.onclick=()=>{ cart.splice(i,1); renderCart(); };
    li.appendChild(rm);
    cartList.appendChild(li);
    total+=item.price;
  });
  cartTotal.textContent=total.toFixed(2);
}

// ---------- Custom Product Modal ----------
const customModal=document.getElementById("customModal");
document.getElementById("addCustomBtn").onclick=()=> customModal.style.display="flex";
document.getElementById("cancelCustom").onclick=()=> customModal.style.display="none";
document.getElementById("saveCustom").onclick=()=>{
  const name=document.getElementById("customName").value.trim();
  const price=parseFloat(document.getElementById("customPrice").value);
  const qty=parseInt(document.getElementById("customQty").value);
  if(!name || isNaN(price) || isNaN(qty)) return alert("Enter valid values");
  for(let i=0;i<qty;i++) cart.push({name, price});
  customModal.style.display="none";
  document.getElementById("customName").value=""; document.getElementById("customPrice").value=""; document.getElementById("customQty").value="";
  renderCart();
};

// ---------- Place Order ----------
document.getElementById("placeOrder").onclick=()=>{
  if(cart.length===0) return alert("Cart empty");
  cart.forEach(item=>{
    const prod=state.products.find(p=>p.name===item.name);
    if(prod) prod.qty-=1;
  });
  const order={ id:"O"+Date.now(), items:[...cart], total:cart.reduce((s,i)=>s+i.price,0), time:new Date().toLocaleString() };
  state.orders.push(order);
  saveState();
  // Auto print receipt
  let receipt=`Order ID: ${order.id}\nTime: ${order.time}\nItems:\n`;
  order.items.forEach(i=> receipt += `- ${i.name} $${i.price.toFixed(2)}\n`);
  receipt += `Total: $${order.total.toFixed(2)}`;
  const newWin=window.open("","Print","width=400,height=600"); newWin.document.write(`<pre>${receipt}</pre>`); newWin.print();
  // WhatsApp send
  const waMsg=encodeURIComponent(receipt);
  window.open(`https://wa.me/50585065976?text=${waMsg}`);
  cart=[]; renderCart(); renderProducts();
};

// ---------- Staff Modal ----------
const staffModal=document.getElementById("staffModal");
document.getElementById("manageStaffBtn").onclick=()=> staffModal.style.display="flex";
document.getElementById("closeStaff").onclick=()=> staffModal.style.display="none";

document.getElementById("saveStaff").onclick=()=>{
  const name=document.getElementById("staffName").value.trim();
  const action=document.getElementById("staffAction").value;
  if(!name) return alert("Enter staff name");
  if(!state.staff[name]) state.staff[name]={checkin:null,totalHours:0,status:"Not Working"};
  const staff=state.staff[name];
  const now=Date.now();
  if(action==="checkin"){
    staff.checkin=now; staff.status="Working";
  } else if(action==="break"){
    if(staff.checkin){ staff.status="Break"; } else return alert("Staff not checked in");
  } else if(action==="checkout"){
    if(staff.checkin){ staff.totalHours += (now-staff.checkin)/(1000*60*60); staff.checkin=null; staff.status="Not Working"; } else return alert("Staff not checked in");
  }
  saveState(); renderStaff();
};

function renderStaff(){
  const list=document.getElementById("staffList");
  list.innerHTML="";
  Object.entries(state.staff).forEach(([name,s])=>{
    const hours=s.totalHours.toFixed(2);
    list.innerHTML += `<li>${name} — ${hours} hrs — ${s.status}${s.checkin? ' • Clocked In' : ''}</li>`;
  });
}

// ---------- Expenses Modal ----------
const expenseModal=document.getElementById("expenseModal");
document.getElementById("manageExpensesBtn").onclick=()=> expenseModal.style.display="flex";
document.getElementById("closeExpense").onclick=()=> expenseModal.style.display="none";

document.getElementById("saveExpense").onclick=()=>{
  const name=document.getElementById("expenseName").value.trim();
  const amount=parseFloat(document.getElementById("expenseAmount").value);
  if(!name || isNaN(amount)) return alert("Enter valid expense");
  state.expenses.push({name,amount,time:new Date().toLocaleString()});
  saveState(); renderExpenses();
  document.getElementById("expenseName").value=""; document.getElementById("expenseAmount").value="";
};

function renderExpenses(){
  const list=document.getElementById("expenseList");
  list.innerHTML="";
  state.expenses.forEach(e=>{
    list.innerHTML += `<li>${e.name} — $${e.amount.toFixed(2)} — ${e.time}</li>`;
  });
}

// ---------- Initial Render ----------
renderProducts(); renderCart(); renderStaff(); renderExpenses();
</script>

</body>
</html>
