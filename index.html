<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SwenShop POS</title>
<style>
  body { background: #000; color: #FFD700; font-family: Arial, sans-serif; margin: 0; padding:0;}
  h1,h2,h3 { color: gold; text-align:center; }
  .container { padding: 10px; }
  /* PIN Modal */
  #pinModal { position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); display:flex; justify-content:center; align-items:center; z-index:999; }
  #pinModal.hidden { display:none; }
  #pinBox { background:#111; padding:20px; border-radius:8px; text-align:center; }
  #pinBox input { padding:10px; font-size:18px; width:120px; text-align:center; margin-bottom:10px; }
  #pinBox button { padding:10px 20px; margin:5px; background:gold; border:none; color:black; font-weight:bold; cursor:pointer; }
  /* Staff section */
  #staffSection { margin-bottom:20px; border:1px solid gold; padding:10px; border-radius:8px; }
  #staffList li { display:flex; justify-content:space-between; margin-bottom:4px; }
  .btnClock { padding:4px 8px; background:gold; color:black; border:none; border-radius:4px; cursor:pointer; font-weight:bold;}
  /* POS Grid */
  #productsGrid { display:grid; grid-template-columns:repeat(auto-fill,minmax(100px,1fr)); gap:10px; }
  .product-card { background:#111; padding:10px; border-radius:8px; text-align:center; display:flex; flex-direction:column; justify-content:space-between;}
  .product-card button { margin-top:5px; padding:6px; background:gold; border:none; color:black; font-weight:bold; cursor:pointer;}
  .badge-low { background:red; color:white; padding:2px 4px; font-size:10px; border-radius:4px; margin-top:4px;}
  /* Cart */
  #cartList li { display:flex; justify-content:space-between; margin-bottom:4px; }
  .btnRemove { background:red; color:white; border:none; border-radius:4px; cursor:pointer; padding:2px 5px; }
  /* Order Actions */
  .order-actions button { width:48%; padding:12px; background:gold; border:none; font-size:16px; color:black; cursor:pointer; border-radius:6px; margin-top:10px; font-weight:bold;}
</style>
</head>
<body>
<!-- PIN Login Modal -->
<div id="pinModal">
  <div id="pinBox">
    <h2>Enter PIN</h2>
    <input type="password" id="pinInput" placeholder="PIN">
    <div>
      <button id="pinLogin">Login</button>
      <button id="pinGuest">Guest</button>
    </div>
  </div>
</div>

<div class="container">
<h1>SwenShop POS</h1>

<!-- Staff Section -->
<div id="staffSection">
<h2>Staff Management</h2>
<input type="text" id="staffNameInput" placeholder="Staff Name">
<button id="addStaffBtn">Add Staff</button>
<ul id="staffList"></ul>
</div>

<!-- Products Grid -->
<h2>Products</h2>
<div id="productsGrid"></div>

<!-- Cart / Order Summary -->
<h2>Order</h2>
Customer Name: <input type="text" id="custName" placeholder="Optional"><br><br>
<ul id="cartList"></ul>
<div>Total: <span id="cartTotal">0</span></div>
<div class="order-actions">
  <button id="placeOrderBtn">Place Order</button>
  <button id="sendWhatsAppBtn">Send WhatsApp</button>
  <button id="printTicketBtn">Print Ticket</button>
  <button onclick="newOrder()">New Order</button>
</div>

</div>

<script>
/* ====== CONFIG ====== */
const WHATSAPP_NUMBER = "50585065976";
const STORE_KEY = "swenpos_allinone_v1";
let state = JSON.parse(localStorage.getItem(STORE_KEY)) || {
    pin:"1234",
    staff:[], // {name, checkedIn:false, time:null}
    products:[
        {name:"Fries Classic", price:3.5, qty:20},
        {name:"Cheesy Fries", price:4.5, qty:12},
        {name:"Bacon Fries", price:5.5, qty:8},
        {name:"Burger", price:7, qty:6},
        {name:"Soda", price:1.5, qty:30},
        {name:"Combo 1", price:10, qty:10},
        {name:"Extra Cheese", price:0.8, qty:50}
    ],
    orders:[]
};

/* ====== PIN LOGIN ====== */
const pinModal = document.getElementById("pinModal");
const pinInput = document.getElementById("pinInput");
document.getElementById("pinLogin").onclick = ()=> {
    if(pinInput.value === state.pin){
        pinModal.classList.add("hidden"); renderAll();
    } else alert("Incorrect PIN");
}
document.getElementById("pinGuest").onclick = ()=> { pinModal.classList.add("hidden"); renderAll(); }

/* ====== Staff Management ====== */
const staffList = document.getElementById("staffList");
const staffNameInput = document.getElementById("staffNameInput");
document.getElementById("addStaffBtn").onclick = ()=> {
    const name = staffNameInput.value.trim();
    if(!name) return;
    state.staff.push({name, checkedIn:false, time:null});
    staffNameInput.value=""; saveState(); renderStaff();
}
function toggleCheckIn(idx){
    const s = state.staff[idx];
    if(!s.checkedIn){
        s.checkedIn = true; s.time = new Date().toLocaleTimeString();
    } else {
        s.checkedIn = false; s.time = null;
    }
    saveState(); renderStaff();
}
function renderStaff(){
    staffList.innerHTML="";
    state.staff.forEach((s,idx)=>{
        const li = document.createElement("li");
        li.innerHTML=`<span>${s.name} ${s.checkedIn?"‚úÖ":"‚ùå"} ${s.time||""}</span>`;
        const btn = document.createElement("button");
        btn.textContent = s.checkedIn?"Clock-Out":"Clock-In";
        btn.className="btnClock"; btn.onclick = ()=> toggleCheckIn(idx);
        li.appendChild(btn);
        staffList.appendChild(li);
    });
}

/* ====== Products Grid ====== */
const productsGrid = document.getElementById("productsGrid");
let cart = [], cartTotal=0;
function renderProducts(){
    productsGrid.innerHTML="";
    state.products.forEach((p,idx)=>{
        const card = document.createElement("div"); card.className="product-card";
        card.innerHTML=`<div>${p.name}</div><div>C$${p.price}</div><div>Stock: ${p.qty}</div>`;
        const btn = document.createElement("button"); btn.textContent="Add";
        btn.disabled = p.qty<=0;
        btn.onclick = ()=> { cart.push(p); cartTotal+=p.price; renderCart(); };
        card.appendChild(btn);
        if(p.qty<=2){ const badge = document.createElement("div"); badge.className="badge-low"; badge.textContent="LOW"; card.appendChild(badge);}
        productsGrid.appendChild(card);
    });
}

/* ====== Cart ====== */
const cartList = document.getElementById("cartList");
const cartTotalEl = document.getElementById("cartTotal");
const custName = document.getElementById("custName");
function renderCart(){
    cartList.innerHTML="";
    cartTotal=0;
    cart.forEach((item,idx)=>{
        const li = document.createElement("li");
        li.innerHTML=`<span>${item.name}</span><span>C$${item.price}</span>`;
        const btn = document.createElement("button"); btn.textContent="X"; btn.className="btnRemove";
        btn.onclick = ()=> { cart.splice(idx,1); renderCart(); };
        li.appendChild(btn);
        cartList.appendChild(li);
        cartTotal+=item.price;
    });
    cartTotalEl.innerText=cartTotal.toFixed(2);
}

/* ====== Orders / Ticket / WhatsApp ====== */
document.getElementById("placeOrderBtn").onclick = ()=> {
    if(cart.length===0){ alert("Cart empty"); return; }
    state.orders.push({items:[...cart], total:cartTotal, customer:custName.value, time:new Date().toISOString()});
    cart=[]; cartTotal=0; custName.value="";
    saveState(); renderCart(); renderAll(); alert("Order placed");
};

document.getElementById("printTicketBtn").onclick = ()=> {
    if(cart.length===0){ alert("Cart empty"); return; }
    const w=window.open("","PRINT","height=600,width=400");
    w.document.write(`<pre style="font-size:18px;">French Fries Bar & Grill
Order Ticket
${new Date().toLocaleString()}

${cart.map(i=>i.name+" - C$"+i.price).join("\n")}

-------------------------
TOTAL: C$${cartTotal.toFixed(2)}
</pre>`);
    w.document.close(); w.focus(); w.print();
};

document.getElementById("sendWhatsAppBtn").onclick = ()=> {
    if(cart.length===0){ alert("Cart empty"); return; }
    let msg=`üî• New Order\n`;
    if(custName.value) msg+=`Customer: ${custName.value}\n`;
    cart.forEach(i=> msg+=`${i.name} - C$${i.price}\n`);
    msg+=`Total: C$${cartTotal.toFixed(2)}\nTime: ${new Date().toLocaleString()}`;
    window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(msg)}`,"_blank");
};

/* ====== New Order ====== */
function newOrder(){ cart=[]; cartTotal=0; custName.value=""; renderCart(); }

/* ====== Save / Load ====== */
function saveState(){ localStorage.setItem(STORE_KEY, JSON.stringify(state)); }

/* ====== Render All ====== */
function renderAll(){ renderStaff(); renderProducts(); renderCart(); }
renderAll();
</script>
</body>
</html>
