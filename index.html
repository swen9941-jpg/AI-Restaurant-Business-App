<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SwenShop POS Pro Touch</title>
<style>
  body { background:#000; color:#FFD700; font-family:Arial,sans-serif; margin:0; padding:0; }
  h1,h2,h3 { text-align:center; color:gold; }
  .container { padding:10px; }
  button { cursor:pointer; }

  /* Modals */
  #pinModal, #staffModal, #customProductModal { position:fixed; top:0; left:0; width:100%; height:100%; display:flex; justify-content:center; align-items:center; z-index:9999; background:rgba(0,0,0,0.9); }
  .hidden { display:none; }
  .modalBox { background:#111; padding:20px; border-radius:8px; text-align:center; max-width:400px; width:90%; }
  .modalBox input, .modalBox select { padding:10px; width:80%; margin-bottom:10px; text-align:center; font-size:18px; }
  .modalBox button { padding:12px 15px; margin:5px; background:gold; color:black; border:none; border-radius:6px; font-weight:bold; font-size:16px; }

  /* Categories Tabs */
  #categories { display:flex; justify-content:center; gap:10px; margin-bottom:10px; flex-wrap:wrap;}
  #categories button { padding:10px 15px; font-size:18px; border-radius:8px; border:none; background:#222; color:gold; flex:1; min-width:100px; }
  #categories button.active { background:gold; color:black; font-weight:bold; }

  /* POS Grid */
  #productsGrid { display:grid; grid-template-columns:repeat(auto-fill,minmax(120px,1fr)); gap:10px; margin-bottom:10px; }
  .product-card { background:#111; padding:10px; border-radius:8px; text-align:center; display:flex; flex-direction:column; justify-content:space-between; height:140px; }
  .product-card button { margin-top:5px; padding:10px; background:gold; border:none; color:black; font-weight:bold; font-size:16px; border-radius:6px; }

  .badge-low { background:red; color:white; padding:2px 4px; font-size:12px; border-radius:4px; margin-top:4px;}

  /* Cart */
  #cartList li { display:flex; justify-content:space-between; margin-bottom:4px; font-size:18px; }
  .btnRemove { background:red; color:white; border:none; border-radius:4px; cursor:pointer; padding:4px 6px; font-size:16px; }

  .order-actions button { width:48%; padding:16px; background:gold; border:none; font-size:18px; color:black; cursor:pointer; border-radius:8px; margin-top:10px; font-weight:bold;}
  input[type="text"]{ font-size:18px; padding:6px; width:100%; margin-bottom:8px; }

  /* Staff Table */
  table { width:100%; border-collapse:collapse; margin-bottom:10px; }
  th, td { border:1px solid gold; padding:6px; text-align:center; font-size:16px; }
  .btnClock { padding:6px 10px; background:gold; color:black; border:none; border-radius:4px; cursor:pointer; font-weight:bold; }
</style>
</head>
<body>

<!-- PIN LOGIN -->
<div id="pinModal">
  <div class="modalBox">
    <h2>Enter PIN</h2>
    <input type="password" id="pinInput" placeholder="PIN">
    <div>
      <button id="pinLogin">Login</button>
      <button id="pinGuest">Guest</button>
    </div>
  </div>
</div>

<!-- STAFF MODAL -->
<div id="staffModal" class="hidden">
  <div class="modalBox">
    <h2>Staff Management</h2>
    <input type="text" id="staffNameInput" placeholder="Staff Name">
    <button id="addStaffBtn">Add Staff</button>
    <table>
      <thead>
        <tr><th>Name</th><th>Status</th><th>Clock-In</th><th>Break</th><th>Clock-Out</th></tr>
      </thead>
      <tbody id="staffList"></tbody>
    </table>
    <button onclick="closeStaffModal()">Close</button>
  </div>
</div>

<!-- CUSTOM PRODUCT MODAL -->
<div id="customProductModal" class="hidden">
  <div class="modalBox">
    <h2>Add Custom Product</h2>
    <input type="text" id="customProdName" placeholder="Product Name">
    <input type="number" id="customProdPrice" placeholder="Price" min="0" step="0.01">
    <button id="addCustomProdBtn">Add to Cart</button>
    <button onclick="closeCustomProductModal()">Cancel</button>
  </div>
</div>

<!-- MAIN CONTAINER -->
<div class="container">
<h1>SwenShop POS Pro Touch</h1>

<button onclick="openStaffModal()">‚öôÔ∏è Staff/Admin Settings</button>

<!-- Categories -->
<div id="categories"></div>

<!-- Products Grid -->
<div id="productsGrid"></div>

<!-- Add Custom Product -->
<button onclick="openCustomProductModal()">‚ûï Add Custom Product</button>

<!-- Cart -->
<h2>Order</h2>
Customer Name: <input type="text" id="custName" placeholder="Optional"><br><br>
<ul id="cartList"></ul>
<div>Total: <span id="cartTotal">0.00</span></div>
<div class="order-actions">
  <button id="placeOrderBtn">Place Order</button>
  <button id="sendWhatsAppBtn">Send WhatsApp</button>
  <button onclick="newOrder()">New Order</button>
</div>
</div>

<script>
/* ===== CONFIG ===== */
const WHATSAPP_NUMBER = "50585065976";
const STORE_KEY = "swenpos_touch_v2";
let state = JSON.parse(localStorage.getItem(STORE_KEY)) || {
    pin:"1234",
    staff:[],
    products:[
        {name:"Fries Classic", price:3.5, qty:20, category:"Fries"},
        {name:"Cheesy Fries", price:4.5, qty:12, category:"Fries"},
        {name:"Bacon Fries", price:5.5, qty:8, category:"Fries"},
        {name:"Burger", price:7, qty:6, category:"Burgers"},
        {name:"Double Burger", price:9, qty:4, category:"Burgers"},
        {name:"Soda", price:1.5, qty:30, category:"Drinks"},
        {name:"Combo 1", price:10, qty:10, category:"Combos"},
        {name:"Combo 2", price:12, qty:5, category:"Combos"}
    ],
    orders:[]
};

let cart=[], cartTotal=0;
let activeCategory = "All";

/* ===== PIN LOGIN ===== */
const pinModal = document.getElementById("pinModal");
const pinInput = document.getElementById("pinInput");
document.getElementById("pinLogin").onclick = ()=>{
    if(pinInput.value === state.pin){ pinModal.classList.add("hidden"); renderAll(); }
    else alert("Incorrect PIN");
}
document.getElementById("pinGuest").onclick = ()=>{ pinModal.classList.add("hidden"); renderAll(); };

/* ===== STAFF MANAGEMENT ===== */
const staffModal = document.getElementById("staffModal");
const staffList = document.getElementById("staffList");
const staffNameInput = document.getElementById("staffNameInput");
document.getElementById("addStaffBtn").onclick = ()=>{
    const name = staffNameInput.value.trim();
    if(!name) return;
    state.staff.push({name, checkedIn:false, onBreak:false, totalTime:0, startTime:null});
    staffNameInput.value=""; saveState(); renderStaff();
}
function openStaffModal(){ staffModal.classList.remove("hidden"); renderStaff(); }
function closeStaffModal(){ staffModal.classList.add("hidden"); }
function clockIn(idx){ const s=state.staff[idx]; if(!s.checkedIn){ s.checkedIn=true; s.startTime=Date.now(); s.onBreak=false; } saveState(); renderStaff(); }
function startBreak(idx){ const s=state.staff[idx]; if(s.checkedIn){ if(!s.onBreak){ s.onBreak=true; s.totalTime += (Date.now()-s.startTime); } else { s.onBreak=false; s.startTime=Date.now(); } } saveState(); renderStaff(); }
function clockOut(idx){ const s=state.staff[idx]; if(s.checkedIn){ if(!s.onBreak) s.totalTime += (Date.now()-s.startTime); s.checkedIn=false; s.startTime=null; s.onBreak=false; alert(`${s.name} worked ${(s.totalTime/1000/60).toFixed(2)} min`); s.totalTime=0; } saveState(); renderStaff(); }
function renderStaff(){ staffList.innerHTML=""; state.staff.forEach((s,idx)=>{ const tr=document.createElement("tr"); tr.innerHTML=`<td>${s.name}</td><td>${s.checkedIn ? (s.onBreak?"On Break":"Working") : "Offline"}</td><td><button class="btnClock" onclick="clockIn(${idx})" ${s.checkedIn?"disabled":""}>Clock-In</button></td><td><button class="btnClock" onclick="startBreak(${idx})" ${!s.checkedIn?"disabled":""}>Break/Resume</button></td><td><button class="btnClock" onclick="clockOut(${idx})" ${!s.checkedIn?"disabled":""}>Clock-Out</button></td>`; staffList.appendChild(tr); }); }

/* ===== CUSTOM PRODUCT ===== */
const customProductModal = document.getElementById("customProductModal");
function openCustomProductModal(){ customProductModal.classList.remove("hidden"); }
function closeCustomProductModal(){ customProductModal.classList.add("hidden"); }
document.getElementById("addCustomProdBtn").onclick = ()=>{
    const name=document.getElementById("customProdName").value.trim();
    const price=parseFloat(document.getElementById("customProdPrice").value);
    if(!name || isNaN(price)) return alert("Invalid input");
    cart.push({name, price});
    renderCart();
    closeCustomProductModal();
    document.getElementById("customProdName").value = "";
    document.getElementById("customProdPrice").value = "";
}

/* ===== CATEGORIES ===== */
const categoriesDiv = document.getElementById("categories");
function renderCategories(){
    const cats = ["All", ...new Set(state.products.map(p=>p.category))];
    categoriesDiv.innerHTML="";
    cats.forEach(cat=>{
        const btn = document.createElement("button");
        btn.textContent = cat;
        btn.className = cat===activeCategory?"active":"";
        btn.onclick = ()=>{ activeCategory=cat; renderProducts(); renderCategories(); };
        categoriesDiv.appendChild(btn);
    });
}

/* ===== PRODUCTS GRID ===== */
const productsGrid = document.getElementById("productsGrid");
function renderProducts(){
    productsGrid.innerHTML="";
    const filtered = activeCategory==="All"?state.products:state.products.filter(p=>p.category===activeCategory);
    filtered.forEach((p,idx)=>{
        const card=document.createElement("div"); card.className="product-card";
        card.innerHTML=`<div>${p.name}</div><div>C$${p.price}</div><div>Stock: ${p.qty}</div>`;
        const btn=document.createElement("button"); btn.textContent="Add"; btn.disabled = p.qty<=0;
        btn.onclick = ()=>{ cart.push(p); cartTotal+=p.price; renderCart(); };
        card.appendChild(btn);
        if(p.qty<=2){ const badge=document.createElement("div"); badge.className="badge-low"; badge.textContent="LOW"; card.appendChild(badge);}
        productsGrid.appendChild(card);
    });
}

/* ===== CART ===== */
const cartList=document.getElementById("cartList");
const cartTotalEl=document.getElementById("cartTotal");
const custName=document.getElementById("custName");
function renderCart(){ cartList.innerHTML=""; cartTotal=0; cart.forEach((item,idx)=>{ const li=document.createElement("li"); li.innerHTML=`<span>${item.name}</span><span>C$${item.price}</span>`; const btn=document.createElement("button"); btn.textContent="X"; btn.className="btnRemove"; btn.onclick=()=>{ cart.splice(idx,1); renderCart(); }; li.appendChild(btn); cartList.appendChild(li); cartTotal+=item.price; }); cartTotalEl.innerText=cartTotal.toFixed(2); }

/* ===== ORDERS / TICKET / WHATSAPP ===== */
document.getElementById("placeOrderBtn").onclick = ()=>{
    if(cart.length===0){ alert("Cart empty"); return; }
    state.orders.push({items:[...cart], total:cartTotal, customer:custName.value, time:new Date().toISOString()});
    saveState(); renderCart(); renderProducts();
    const w=window.open("","PRINT","height=600,width=400");
    w.document.write(`<pre style="font-size:18px;">French Fries Bar & Grill
Order Ticket
${new Date().toLocaleString()}

${cart.map(i=>i.name+" - C$"+i.price).join("\n")}

-------------------------
TOTAL: C$${cartTotal.toFixed(2)}
</pre>`);
    w.document.close(); w.focus(); w.print();
    cart=[]; cartTotal=0; custName.value=""; renderCart();
};

document.getElementById("sendWhatsAppBtn").onclick = ()=>{
    if(cart.length===0){ alert("Cart empty"); return; }
    let msg=`üî• New Order\n`;
    if(custName.value) msg+=`Customer: ${custName.value}\n`;
    cart.forEach(i=> msg+=`${i.name} - C$${i.price}\n`);
    msg+=`Total: C$${cartTotal.toFixed(2)}\nTime: ${new Date().toLocaleString()}`;
    window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(msg)}`,"_blank");
};

/* ====== New Order ===== */
function newOrder(){ cart=[]; cartTotal=0; custName.value=""; renderCart(); }

/* ====== SAVE / LOAD ===== */
function saveState(){ localStorage.setItem(STORE_KEY, JSON.stringify(state)); }

/* ====== RENDER ALL ===== */
function renderAll(){ renderCategories(); renderProducts(); renderCart(); renderStaff(); }
renderAll();
</script>

</body>
</html>
